{"nftables": [{"flush": {"ruleset": null}}, {"table": {"family": "inet", "name": "inet_table"}}, {"set": {"family": "inet", "type": "ipv4_addr", "name": "self_v4", "table": "inet_table", "flags": ["interval"], "elem": ["10.250.109.20"]}}, {"set": {"family": "inet", "type": "ipv6_addr", "name": "self_v6", "table": "inet_table", "flags": ["interval"], "elem": ["2a01:8000:5:9::27"]}}, {"set": {"family": "inet", "type": "ipv4_addr", "name": "Servers_v4", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "10.250.100.0", "len": 24}}]}}, {"set": {"family": "inet", "type": "ipv6_addr", "name": "Servers_v6", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "2a01:8000:5:2::", "len": 64}}]}}, {"set": {"family": "inet", "type": "ipv4_addr", "name": "VDI_v4", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "10.250.103.0", "len": 24}}]}}, {"set": {"family": "inet", "type": "ipv6_addr", "name": "VDI_v6", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "2a01:8000:5:3::", "len": 64}}]}}, {"set": {"family": "inet", "type": "ipv4_addr", "name": "VPN_v4", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "10.250.98.0", "len": 24}}]}}, {"set": {"family": "inet", "type": "inet_service", "name": "dns_tcp", "table": "inet_table", "flags": ["interval"], "elem": [53]}}, {"set": {"family": "inet", "type": "inet_service", "name": "dns_udp", "table": "inet_table", "flags": ["interval"], "elem": [53]}}, {"set": {"family": "inet", "type": "inet_service", "name": "ssh", "table": "inet_table", "flags": ["interval"], "elem": [22]}}, {"set": {"family": "inet", "type": "inet_service", "name": "mysql", "table": "inet_table", "flags": ["interval"], "elem": [3306]}}, {"set": {"family": "inet", "type": "ipv4_addr", "name": "DC1_v4", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "10.250.100.0", "len": 24}}, {"prefix": {"addr": "10.250.103.0", "len": 24}}]}}, {"set": {"family": "inet", "type": "ipv6_addr", "name": "DC1_v6", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "2a01:8000:5:2::", "len": 64}}, {"prefix": {"addr": "2a01:8000:5:3::", "len": 64}}]}}, {"set": {"family": "inet", "type": "inet_service", "name": "domain_tcp", "table": "inet_table", "flags": ["interval"], "elem": [53]}}, {"set": {"family": "inet", "type": "inet_service", "name": "domain_udp", "table": "inet_table", "flags": ["interval"], "elem": [53]}}, {"set": {"family": "inet", "type": "ipv4_addr", "name": "doublenesting_v4", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "10.250.100.0", "len": 24}}, {"prefix": {"addr": "10.250.103.0", "len": 24}}, {"prefix": {"addr": "10.250.98.0", "len": 24}}]}}, {"set": {"family": "inet", "type": "ipv6_addr", "name": "doublenesting_v6", "table": "inet_table", "flags": ["interval"], "elem": [{"prefix": {"addr": "2a01:8000:5:2::", "len": 64}}, {"prefix": {"addr": "2a01:8000:5:3::", "len": 64}}]}}, {"set": {"family": "inet", "type": "inet_service", "name": "doublenesetedservice_tcp", "table": "inet_table", "flags": ["interval"], "elem": [53, 22]}}, {"set": {"family": "inet", "type": "inet_service", "name": "doublenesetedservice_udp", "table": "inet_table", "flags": ["interval"], "elem": [53]}}, {"chain": {"table": "inet_table", "family": "inet", "name": "tcp_chain", "policy": "accept"}}, {"chain": {"table": "inet_table", "family": "inet", "name": "udp_chain", "policy": "accept"}}, {"chain": {"table": "inet_table", "family": "inet", "name": "icmp_chain", "policy": "accept"}}, {"chain": {"table": "inet_table", "family": "inet", "name": "icmpv6_chain", "policy": "accept"}}, {"chain": {"table": "inet_table", "family": "inet", "name": "icmp-local_chain", "policy": "accept"}}, {"chain": {"table": "inet_table", "family": "inet", "name": "icmpv6-local_chain", "policy": "accept"}}, {"chain": {"table": "inet_table", "family": "inet", "name": "input_chain", "policy": "accept", "type": "filter", "hook": "input", "prio": 0}}, {"chain": {"table": "inet_table", "family": "inet", "name": "forward_chain", "policy": "accept", "type": "filter", "hook": "forward", "prio": 0}}, {"chain": {"table": "inet_table", "family": "inet", "name": "output_chain", "policy": "accept", "type": "filter", "hook": "output", "prio": 0}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "in", "left": {"ct": {"key": "state"}}, "right": ["established", "related"]}}, {"accept": null}]}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iif"}}, "right": "lo"}}, {"accept": null}]}}, {"rule": {"chain": "icmp-local_chain", "table": "inet_table", "family": "inet", "expr": [{"accept": null}]}}, {"rule": {"chain": "icmpv6-local_chain", "table": "inet_table", "family": "inet", "expr": [{"accept": null}]}}, {"rule": {"chain": "icmp_chain", "table": "inet_table", "family": "inet", "expr": [{"accept": null}]}}, {"rule": {"chain": "icmpv6_chain", "table": "inet_table", "family": "inet", "expr": [{"accept": null}]}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "tcp"}}, {"jump": {"target": "tcp_chain"}}]}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "udp"}}, {"jump": {"target": "udp_chain"}}]}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "nexthdr"}}, "right": "tcp"}}, {"jump": {"target": "tcp_chain"}}]}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "nexthdr"}}, "right": "udp"}}, {"jump": {"target": "udp_chain"}}]}}, {"rule": {"chain": "forward_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "tcp"}}, {"jump": {"target": "tcp_chain"}}]}}, {"rule": {"chain": "forward_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "protocol"}}, "right": "udp"}}, {"jump": {"target": "udp_chain"}}]}}, {"rule": {"chain": "forward_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "nexthdr"}}, "right": "tcp"}}, {"jump": {"target": "tcp_chain"}}]}}, {"rule": {"chain": "forward_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "nexthdr"}}, "right": "udp"}}, {"jump": {"target": "udp_chain"}}]}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmp", "field": "type"}}, "right": {"set": ["destination-unreachable", "router-advertisement", "router-solicitation", "time-exceeded", "parameter-problem"]}}}, {"jump": {"target": "icmp-local_chain"}}]}}, {"rule": {"chain": "input_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmpv6", "field": "type"}}, "right": {"set": ["destination-unreachable", "packet-too-big", "time-exceeded", "parameter-problem", "mld-listener-query", "mld-listener-report", "mld-listener-done", "nd-router-solicit", "nd-router-advert", "nd-neighbor-solicit", "nd-neighbor-advert", "ind-neighbor-solicit", "ind-neighbor-advert", "mld2-listener-report"]}}}, {"jump": {"target": "icmpv6-local_chain"}}]}}, {"rule": {"chain": "forward_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmp", "field": "type"}}, "right": {"set": ["destination-unreachable", "router-advertisement", "router-solicitation", "time-exceeded", "parameter-problem"]}}}, {"jump": {"target": "icmp_chain"}}]}}, {"rule": {"chain": "forward_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmpv6", "field": "type"}}, "right": {"set": ["destination-unreachable", "packet-too-big", "time-exceeded", "parameter-problem", "mld-listener-query", "mld-listener-report", "mld-listener-done", "nd-router-solicit", "nd-router-advert", "nd-neighbor-solicit", "nd-neighbor-advert", "ind-neighbor-solicit", "ind-neighbor-advert", "mld2-listener-report"]}}}, {"jump": {"target": "icmpv6_chain"}}]}}, {"rule": {"chain": "tcp_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "@self_v4"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@ssh"}}, {"log": {"prefix": "some-uuid", "group": 0}}, {"accept": null}]}}, {"rule": {"chain": "tcp_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "daddr"}}, "right": "@self_v6"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@ssh"}}, {"log": {"prefix": "some-uuid", "group": 0}}, {"accept": null}]}}, {"rule": {"chain": "tcp_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "@self_v4"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@dns_tcp"}}, {"log": {"prefix": "some-uuid", "group": 0}}, {"accept": null}]}}, {"rule": {"chain": "tcp_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "daddr"}}, "right": "@self_v6"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@dns_tcp"}}, {"log": {"prefix": "some-uuid", "group": 0}}, {"accept": null}]}}, {"rule": {"chain": "tcp_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "@self_v4"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@mysql"}}, {"log": {"prefix": "some-uuid2", "group": 0}}, {"accept": null}]}}, {"rule": {"chain": "tcp_chain", "table": "inet_table", "family": "inet", "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "daddr"}}, "right": "@self_v6"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": "@mysql"}}, {"log": {"prefix": "some-uuid2", "group": 0}}, {"accept": null}]}}]}
